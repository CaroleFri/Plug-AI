Loading pytorch-gpu/py3/1.10.1
  Loading requirement: cuda/11.2 nccl/2.9.6-1-cuda cudnn/8.1.1.33-cuda gcc/8.4.1
    openmpi/4.1.1-cuda intel-mkl/2020.4 magma/2.5.4-cuda sox/14.4.2
+ srun python plug_ai/main.py --config_file ./config_exemples/config_BrainTumour.yaml
Initialize training...
Final Args: {'mode': 'Training', 'model_name': 'model_test', 'dataset_dir': '/gpfswork/rech/ibu/commun/Task01_BrainTumour', 'task': 'THIS IS A TEST', 'n_class': 4, 'categories': ['cat0', 'cat1', 'cat2', 'cat3'], 'limit_sample': 20, 'batch_size': 2, 'nb_epoch': 1, 'learning_rate': '5e-05', 'device': 'cuda', 'random_seed': 2022, 'verbose': 'Full', 'export_config': False, 'report_log': True, 'checkpoints_path': './checkpoints', 'dynunet_kernels': [[3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3]], 'dynunet_strides': [[1, 1, 1], [2, 2, 2], [2, 2, 2], [2, 2, 2], [2, 2, 2], [2, 2, 2]], 'in_channels': 4, 'config_file': './config_exemples/config_BrainTumour.yaml'}
arguments loaded
loading dataset...
got datalist, extract: 
 {'channel_0': '/gpfswork/rech/ibu/commun/Task01_BrainTumour/imagesTr/BRATS_001.nii.gz', 'label': '/gpfswork/rech/ibu/commun/Task01_BrainTumour/labelsTr/BRATS_001.nii.gz'}
dataset loaded ! Loading checkpoints...
Model loaded ! Initialize training...
recording tensorboard logs
start training loop, 10 steps per epoch
[Epoch 1/1 |  Step_Epoch 1/10 | Loss 3.263692617416382]
[Epoch 1/1 |  Step_Epoch 2/10 | Loss 3.233896255493164]
[Epoch 1/1 |  Step_Epoch 3/10 | Loss 3.154094696044922]
[Epoch 1/1 |  Step_Epoch 4/10 | Loss 3.1936068534851074]
[Epoch 1/1 |  Step_Epoch 5/10 | Loss 3.2260758876800537]
[Epoch 1/1 |  Step_Epoch 6/10 | Loss 3.184732437133789]
[Epoch 1/1 |  Step_Epoch 7/10 | Loss 3.166731119155884]
[Epoch 1/1 |  Step_Epoch 8/10 | Loss 3.2036290168762207]
[Epoch 1/1 |  Step_Epoch 9/10 | Loss 3.118248462677002]
[Epoch 1/1 |  Step_Epoch 10/10 | Loss 3.18487811088562]
Training complete, saving model...
model saved !
